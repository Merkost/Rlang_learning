# Задание 12. Задачи по теме Анализ качественных признаков

# 12.1
больные <- as.data.frame(matrix(c(23, 4, 6, 17), nrow = 2, byrow = TRUE))
colnames(больные) <- c("Прибор включен", "Прибор выключен")
rownames(больные) <- c("Боли нет", "Боль есть")
mosaicplot(больные,
           main = "Mosaic plot",
           color = TRUE
)
# Из графика видно, что тех, у кого нет боли в выборке выше среди включенного прибора,
# чем среди тех, кто испытывает боль.

# точный тест Фишера используется, когда в таблице случайностей есть
# хотя бы одна ячейка с ожидаемыми частотами меньше 5. Проверим
chisq.test(больные)$expected
# Мы должны использовать тест Хи-квадрат вместо точного теста Фишера,
# потому что нет по крайней мере одной ячейки со значением ниже 5.
chisq.test(больные)
# p-value = 8.411e-05, что меньше 0.05.
# Это позволяет отвергнуть нулевую гипотезу и принять альтернативную.
# Данные позволяют считать высокочастотную стимуляцию нерва
# действенным анальгезируюшим средством.

# 12.2
water.infection <- as.data.frame(matrix(c(39, 121, 264, 258, 265, 146), nrow = 3, byrow = TRUE))
colnames(water.infection) <- c("Число заболевших", "Число не заболевших")
rownames(water.infection) <- c("Менее 1", "1-4", "5 и более")
mosaicplot(water.infection, main = "Mosaic plot", color = TRUE)
# Посмотрим, какой тест лучше использовать
chisq.test(water.infection)$expected
# Снова мы должны использовать тест Хи-квадрат вместо точного теста Фишера,
# потому что нет по крайней мере одной ячейки со значением ниже 5.
chisq.test(water.infection)
# p-value < 2.2e-16, что гораздо меньше 0.05.
# Это позволяет отвергнуть нулевую гипотезу и принять альтернативную.
# Переменные являются зависимыми, между двумя категориальными переменными
# существует взаимосвязь.
# Знание значения одной переменной помогает предсказать значение другой переменной.

# 12.3
group <- read.table('12/group.rd', header = T)
sex.f <- factor(group$`Пол`)
table(sex.f)
# Женский Мужской
#       6      14
binom.test(x = 6, n = 20, p = 0.5)
# p-value = 0.1153, считается, что разница не является статистически значимой.
# (т.к. p-value > 0.05)

