###### Lecture 14 ###############################################
####### Регрессионный анализ ###############
y <- c(109.14, 117.55, 106.76, 115.26, 117.13, 125.39, 121.03, 114.03, 124.83, 113.92, 122.04, 109.41, 131.61, 103.93, 116.64, 117.06, 111.73, 120.41, 112.98, 101.20, 120.19,
       128.53, 120.14, 108.70, 130.77, 110.16, 129.07, 123.46, 130.02, 130.31, 135.06, 129.17, 137.08, 107.62, 139.77,
       121.47, 130.95, 138.15, 114.31, 134.58, 135.86, 138.49,
       110.01, 127.80, 122.57, 136.99, 139.53, 127.34, 132.26,
       120.85, 124.99, 133.36, 142.46, 123.58, 145.05, 127.83,
       140.42, 149.64, 151.01, 135.69, 138.25, 127.24, 135.55,
       142.76, 146.67, 146.33, 137.00, 145.00, 143.98, 143.81,
       159.92, 160.97, 157.45, 145.68, 129.98, 137.45, 151.22, 136.10, 150.60, 148.79, 167.93, 160.85, 146.28, 145.97,
       135.59, 156.62, 153.12, 165.96, 160.94, 168.87, 167.64,
       154.64, 152.46, 149.03, 159.56, 149.31, 153.56, 170.87,
       163.52, 150.97)

x <- rep(seq(16, 65, 1), each = 2)
plot(x, y)

##### b=cov(x,y)/var(x); a=mean(y)-mean(x)b
cov(x, y)
var(x)
(b <- cov(x, y) / var(x))
(a <- mean(y) - mean(x) * b)
lines(x, a + b * x, col = "blue")

(X <- cbind(rep(1, 100), x)) # матррица Х
(X1 <- t(X) %*% X) # X'X
(X2 <- solve(X1)) # обратная матрица для X'X
X2 %*% t(X) %*% y # вектор коэффициентов

lm(y ~ x)
summary(lm(y ~ x))
